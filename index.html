<!DOCTYPE html>
<html>
<head>
    <title>Box Rain Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.18.0/matter.min.js"></script>
    <style>
        /* styles.css */
        body {
            margin: 0;
            overflow: hidden;
            cursor: crosshair;
            position: relative;
        }
        
        #game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #background {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
        }

        #game-canvas {
            position: absolute;
            z-index: 2;
        }

        #character {
            position: absolute;
            z-index: 3;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <img id="background" src="wall1.jpg" alt="Background">
        <canvas id="game-canvas"></canvas>
        <img id="character" src="R1.jpg" alt="Character">
    </div>

    <script>
        // config.js
        const CONFIG = {
            GAME_WIDTH: 1920,
            GAME_HEIGHT: 1080,
            CHARACTER: {
                WIDTH: 1337,
                HEIGHT: 216,
                Y_POSITION: 1080 - 216 // Нижний край экрана
            },
            BOX: {
                SIZE: 177,
                SPAWN_OFFSET: -100,
                PHYSICS: {
                    density: 0.8,
                    friction: 0.5,
                    restitution: 0.3
                }
            }
        };

        // main.js
        const Engine = Matter.Engine,
            Render = Matter.Render,
            World = Matter.World,
            Bodies = Matter.Bodies;

        // Инициализация движка
        const engine = Matter.Engine.create();
        
        // Настройка рендерера
        const render = Matter.Render.create({
            element: document.getElementById('game-container'),
            engine: engine,
            canvas: document.getElementById('game-canvas'),
            options: {
                width: CONFIG.GAME_WIDTH,
                height: CONFIG.GAME_HEIGHT,
                wireframes: false,
                background: 'transparent'
            }
        });

        // Инициализация персонажа
        const character = Bodies.rectangle(
            CONFIG.GAME_WIDTH / 2,
            CONFIG.CHARACTER.Y_POSITION + CONFIG.CHARACTER.HEIGHT / 2,
            CONFIG.CHARACTER.WIDTH,
            CONFIG.CHARACTER.HEIGHT,
            {
                isStatic: true,
                render: {
                    fillStyle: 'transparent'
                }
            }
        );

        // Границы мира
        const boundaries = [
            Bodies.rectangle( // Пол (персонаж)
                CONFIG.GAME_WIDTH / 2,
                CONFIG.GAME_HEIGHT + 50,
                CONFIG.GAME_WIDTH,
                100,
                { isStatic: true, render: { visible: false } }
            ),
            Bodies.rectangle( // Левая стена
                -50,
                CONFIG.GAME_HEIGHT / 2,
                100,
                CONFIG.GAME_HEIGHT,
                { isStatic: true, render: { visible: false } }
            ),
            Bodies.rectangle( // Правая стена
                CONFIG.GAME_WIDTH + 50,
                CONFIG.GAME_HEIGHT / 2,
                100,
                CONFIG.GAME_HEIGHT,
                { isStatic: true, render: { visible: false } }
            )
        ];

        // Добавление объектов в мир
        World.add(engine.world, [character, ...boundaries]);

        // Обработка кликов
        document.addEventListener('click', (e) => {
            const rect = render.canvas.getBoundingClientRect();
            const scaleX = render.canvas.width / rect.width;
            const scaleY = render.canvas.height / rect.height;
            
            const box = Bodies.rectangle(
                (e.clientX - rect.left) * scaleX,
                CONFIG.BOX.SPAWN_OFFSET,
                CONFIG.BOX.SIZE,
                CONFIG.BOX.SIZE,
                {
                    ...CONFIG.BOX.PHYSICS,
                    render: {
                        sprite: {
                            texture: 'boxX.png',
                            xScale: 1,
                            yScale: 1
                        }
                    }
                }
            );
            
            World.add(engine.world, box);
        });

        // Запуск движка
        Engine.run(engine);
        Matter.Render.run(render);

        // Адаптация под размер экрана
        function resize() {
            const canvas = render.canvas;
            const container = document.getElementById('game-container');
            
            const scale = Math.min(
                window.innerWidth / CONFIG.GAME_WIDTH,
                window.innerHeight / CONFIG.GAME_HEIGHT
            );
            
            canvas.style.transform = `scale(${scale})`;
            container.style.height = `${window.innerHeight}px`;
        }

        window.addEventListener('resize', resize);
        resize();
    </script>
</body>
</html>

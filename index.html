<!DOCTYPE html>
<html>
<head>
    <title>–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —à–∏—Ñ—Ä–∞—Ç–æ—Ä/–¥–µ—à–∏—Ñ—Ä–∞—Ç–æ—Ä</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            height: 100px;
            margin: 10px 0;
            padding: 10px;
            border: 2px solid #4CAF50;
            border-radius: 5px;
            resize: vertical;
        }
        button {
            padding: 12px 25px;
            background: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .warning {
            color: #ff4444;
            font-size: 14px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê –®–∏—Ñ—Ä–∞—Ç–æ—Ä/–î–µ—à–∏—Ñ—Ä–∞—Ç–æ—Ä ¬´–ó–µ—Ä–∫–∞–ª—å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç¬ª</h1>
        <textarea id="input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..."></textarea>
        <div>
            <button onclick="encrypt()">–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å ‚Üí</button>
            <button onclick="decrypt()">‚Üê –î–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
            <button onclick="clearAll()">–û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        <textarea id="output" readonly placeholder="–†–µ–∑—É–ª—å—Ç–∞—Ç..."></textarea>
        <div class="warning" id="warning"></div>
    </div>

    <script>
        // –¢–∞–±–ª–∏—Ü–∞ –∑–∞–º–µ–Ω—ã (—Ä—É—Å—Å–∫–∏–π, –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, —Ñ–∏–Ω—Å–∫–∏–π)
        const substitutionTable = {
            // –†—É—Å—Å–∫–∏–π
            '–ê': '√ÑR', '–ë': 'B%', '–í': 'V#', '–ì': 'G&', '–î': 'DŒî', 
            '–ï': 'E‚Ç¨', '–Å': 'YO', '–ñ': '≈Ω', '–ó': 'Z3', '–ò': 'IŒ†', 
            '–ô': 'J–ô', '–ö': 'KŒ∫', '–õ': 'LŒõ', '–ú': 'MŒº', '–ù': 'H√ë', 
            '–û': 'O√ò', '–ü': 'PŒ†', '–†': 'R¬Æ', '–°': 'S$', '–¢': 'TœÑ', 
            '–£': 'U√ú', '–§': 'FŒ¶', '–•': 'XŒß', '–¶': 'C–¶', '–ß': 'ƒå', 
            '–®': '≈†', '–©': '≈ú', '–™': '–™', '–´': 'YI', '–¨': '–¨', 
            '–≠': 'E√Ñ', '–Æ': 'JU', '–Ø': 'JA',
            
            // –ê–Ω–≥–ª–∏–π—Å–∫–∏–π
            'A': 'A√Ö', 'B': 'BŒ≤', 'C': 'C¬©', 'D': 'D√ê', 'E': 'E√Ü', 
            'F': 'F∆í', 'G': 'GŒì', 'H': 'HŒ®', 'I': 'I√ç', 'J': 'Jƒ¥', 
            'K': 'K‚Ç≠', 'L': 'L≈Å', 'M': 'MŒú', 'N': 'N√ë', 'O': 'O√ñ', 
            'P': 'P√û', 'Q': 'QŒ©', 'R': 'RŒ°', 'S': 'S√ü', 'T': 'T≈¶', 
            'U': 'U√õ', 'V': 'V—∂', 'W': 'W≈¥', 'X': 'XŒû', 'Y': 'Y≈∏', 
            'Z': 'Z≈Ω',
            
            // –§–∏–Ω—Å–∫–∏–π
            '√Ñ': '√Ñ√Ñ', '√ñ': '√ñ√ñ', '√Ö': '√Ö√Ö',
            
            // –°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã
            ' ': '¬ß', '?': '¬ø', '!': '¬°', ',': '‚Äö', '.': '‚Ä¢',
            '1': '‚ÇÅ', '2': '‚ÇÇ', '3': '‚ÇÉ', '4': '‚ÇÑ', '5': '‚ÇÖ',
            '6': '‚ÇÜ', '7': '‚Çá', '8': '‚Çà', '9': '‚Çâ', '0': '‚ÇÄ'
        };

        // –û–±—Ä–∞—Ç–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∏
        const reverseTable = {};
        Object.entries(substitutionTable).forEach(([key, value]) => {
            reverseTable[value] = key;
        });

        // ================= –®–ò–§–†–û–í–ê–ù–ò–ï =================
        function substitute(text) {
            return text.toUpperCase().split('').map(char => {
                return substitutionTable[char] || char;
            }).join('');
        }

        function mirror(text) {
            const chunkSize = 2;
            const chunks = [];
            for (let i = 0; i < text.length; i += chunkSize) {
                chunks.push(text.slice(i, i + chunkSize));
            }
            return chunks.reverse().join('');
        }

        function addAsciiShift(text) {
            return text.split('').map((char, index) => {
                const shift = (index % 3 + 1) * 2;
                return char + (char.charCodeAt(0) * shift).toString(16);
            }).join(':');
        }

        function encrypt() {
            document.getElementById('warning').innerText = '';
            const input = document.getElementById('input').value;
            
            let result = substitute(input);
            result = mirror(result);
            result = addAsciiShift(result);
            
            document.getElementById('output').value = result;
        }

        // ================= –î–ï–®–ò–§–†–û–í–ö–ê =================
        function removeAsciiShift(encrypted) {
            const segments = encrypted.split(':');
            let mirrored = '';
            for (let i = 0; i < segments.length; i++) {
                const segment = segments[i];
                if (!segment) continue;
                const char = segment[0];
                const hex = segment.slice(1);
                const shift = (i % 3 + 1) * 2;
                const code = parseInt(hex, 16);
                if (isNaN(code) || code % shift !== 0) {
                    document.getElementById('warning').innerText = 
                        `‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ: ${segment}`;
                    return null;
                }
                mirrored += String.fromCharCode(code / shift);
            }
            return mirrored;
        }

        function unmirror(text) {
            const chunkSize = 2;
            const chunks = [];
            for (let i = 0; i < text.length; i += chunkSize) {
                chunks.push(text.slice(i, i + chunkSize));
            }
            return chunks.reverse().join('');
        }

        function reverseSubstitute(text) {
            const chunkSize = 2;
            let result = '';
            for (let i = 0; i < text.length; i += chunkSize) {
                const code = text.slice(i, i + chunkSize);
                result += reverseTable[code] || code;
            }
            return result;
        }

        function decrypt() {
            document.getElementById('warning').innerText = '';
            const encrypted = document.getElementById('input').value;
            
            const mirrored = removeAsciiShift(encrypted);
            if (!mirrored) return;
            
            const substituted = unmirror(mirrored);
            const result = reverseSubstitute(substituted);
            
            document.getElementById('output').value = result;
        }

        // ================= –û–ß–ò–°–¢–ö–ê =================
        function clearAll() {
            document.getElementById('input').value = '';
            document.getElementById('output').value = '';
            document.getElementById('warning').innerText = '';
        }
    </script>
</body>
</html>
